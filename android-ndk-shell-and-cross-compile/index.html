<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Android NDK 开发之 shell 脚本和交叉编译 - midFang&#39;s Blog</title>
  

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="midFang" />
  <meta name="description" content="当编译过程比较复杂的时候, 我们就可以使用 shell 脚本来简化这个过程, 同时版本升级, 重复构建的基础上 shell 脚本也能够重复利用, 下面直接开始看看 shell 脚本是如" />

  <meta name="keywords" content="Hugo, theme, jane" />






<meta name="generator" content="Hugo 0.58.3" />


<link rel="canonical" href="https://midFang.github.io/android-ndk-shell-and-cross-compile/" />





<link rel="icon" href="/favicon.ico" />











<link rel="stylesheet" href="/sass/jane.min.af20b78e95c84de86b00a0242a4a77bd2601700e1b250edf27537d957ac0041d.css" integrity="sha256-ryC3jpXITehrAKAkKkp3vSYBcA4bJQ7fJ1N9lXrABB0=" media="screen" crossorigin="anonymous">





<meta property="og:title" content="Android NDK 开发之 shell 脚本和交叉编译" />
<meta property="og:description" content="当编译过程比较复杂的时候, 我们就可以使用 shell 脚本来简化这个过程, 同时版本升级, 重复构建的基础上 shell 脚本也能够重复利用, 下面直接开始看看 shell 脚本是如" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://midFang.github.io/android-ndk-shell-and-cross-compile/" />
<meta property="article:published_time" content="2024-03-17T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-03-17T00:00:00+00:00" />
<meta itemprop="name" content="Android NDK 开发之 shell 脚本和交叉编译">
<meta itemprop="description" content="当编译过程比较复杂的时候, 我们就可以使用 shell 脚本来简化这个过程, 同时版本升级, 重复构建的基础上 shell 脚本也能够重复利用, 下面直接开始看看 shell 脚本是如">


<meta itemprop="datePublished" content="2024-03-17T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2024-03-17T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="3451">



<meta itemprop="keywords" content="NDK,shell," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Android NDK 开发之 shell 脚本和交叉编译"/>
<meta name="twitter:description" content="当编译过程比较复杂的时候, 我们就可以使用 shell 脚本来简化这个过程, 同时版本升级, 重复构建的基础上 shell 脚本也能够重复利用, 下面直接开始看看 shell 脚本是如"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->




</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">midFang's Blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://midFang.github.io/">首页</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://midFang.github.io/post/">全部文章</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://midFang.github.io/tags/">标签</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://midFang.github.io/categories/">分类</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://midFang.github.io/about/">关于</a>
          
        
      </li>
    

    
      <li class="mobile-menu-item">
        <a id="openSearchMobile" class="mobile-menu-item-link menu-item-search" href="#">
          <i class="iconfont">
            <svg version="1.1" viewBox="0 0 1024 1024"
  xmlns="http://www.w3.org/2000/svg" width="18" height="18"
  xmlns:xlink="http://www.w3.org/1999/xlink">
  <path d="M973.81454219 973.81454219a91.78207815 91.78207815 0 0 1-129.80999631 0l-161.97482118-161.97482118a425.48527711 425.48527711 0 0 1-230.35931791 68.16531768 428.3346319 428.3346319 0 1 1 428.3346319-428.3346319 425.48527711 425.48527711 0 0 1-68.16531768 230.35931791l162.02961656 161.97482118a91.83687354 91.83687354 0 0 1-0.05479538 129.80999631zM451.67040679 145.69361559a305.97679241 305.97679241 0 1 0 0 611.95358361 305.97679241 305.97679241 0 0 0 0-611.95358361z">
  </path>
</svg>

          </i>
        </a>
      </li>
    
  </ul>
</nav>


  

  
    
<div class="modal-dialog">
    
    <div class="modal-content">
      <div id="closeSearch" title="Close" class="close">X</div>
      <div class="modal-header">
        <div class="modal-title">Search</div>
      </div>
      <div class="modal-body">
          <script>
            (function() {
              var cx = '57787f7f4d21d54fc';
              var gcse = document.createElement('script');
              gcse.type = 'text/javascript';
              gcse.async = true;
              gcse.src = (document.location.protocol == 'https:' ? 'https:' :
                  'http:') +
                '//cse.google.com/cse.js?cx=' + cx;
              var s = document.getElementsByTagName('script')[0];
              s.parentNode.insertBefore(gcse, s);
            })();
          </script>
          <gcse:search></gcse:search>
      </div>
    </div>
</div>

  

  

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="/" class="logo">
    
      midFang's Blog
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://midFang.github.io/">首页</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://midFang.github.io/post/">全部文章</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://midFang.github.io/tags/">标签</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://midFang.github.io/categories/">分类</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://midFang.github.io/about/">关于</a>
          

        

      </li>
    

    
    

    
      <li class="menu-item">
        <a id="openSearch" class="menu-item-link menu-item-search" href="#">
          <i class="iconfont">
            <svg version="1.1" viewBox="0 0 1024 1024"
  xmlns="http://www.w3.org/2000/svg" width="18" height="18"
  xmlns:xlink="http://www.w3.org/1999/xlink">
  <path d="M973.81454219 973.81454219a91.78207815 91.78207815 0 0 1-129.80999631 0l-161.97482118-161.97482118a425.48527711 425.48527711 0 0 1-230.35931791 68.16531768 428.3346319 428.3346319 0 1 1 428.3346319-428.3346319 425.48527711 425.48527711 0 0 1-68.16531768 230.35931791l162.02961656 161.97482118a91.83687354 91.83687354 0 0 1-0.05479538 129.80999631zM451.67040679 145.69361559a305.97679241 305.97679241 0 1 0 0 611.95358361 305.97679241 305.97679241 0 0 0 0-611.95358361z">
  </path>
</svg>

          </i>
        </a>
      </li>
    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">Android NDK 开发之 shell 脚本和交叉编译</h1>
      
      <div class="post-meta">
        <time datetime="2024-03-17" class="post-time">
          2024-03-17
        </time>
        <div class="post-category">
            <a href="https://midFang.github.io/categories/ndk/"> NDK </a>
            <a href="https://midFang.github.io/categories/shell/"> shell </a>
            
          </div>
        

        
        
          <span id="busuanzi_container_page_pv">
            | 阅读 <span id="busuanzi_value_page_pv"></span>
          </span>
        

        
        
          <span id="/android-ndk-shell-and-cross-compile/" class="leancloud_visitors" data-flag-title="Android NDK 开发之 shell 脚本和交叉编译">
            <span class="post-meta-item-text"> | 阅读 </span>
            <span class="leancloud-visitors-count"></span>
          </span>
        
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">Table of Contents</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#hello-shell">hello shell</a></li>
<li><a href="#变量">变量</a></li>
<li><a href="#获取参数">获取参数</a></li>
<li><a href="#预定义变量">预定义变量</a></li>
<li><a href="#条件判断和数字使用">条件判断和数字使用</a>
<ul>
<li><a href="#条件判断">条件判断</a></li>
<li><a href="#数字">数字：</a></li>
<li><a href="#文件">文件：</a></li>
</ul></li>
<li><a href="#函数">函数</a></li>
<li><a href="#循环和switch">循环和switch</a></li>
<li><a href="#输出日志到文件中">输出日志到文件中</a>
<ul>
<li><a href="#临时重定向">临时重定向</a></li>
<li><a href="#永久重定向">永久重定向</a></li>
</ul></li>
<li><a href="#交叉编译">交叉编译</a></li>
<li><a href="#android-中-导入第三方-so-库">Android 中 导入第三方 so 库</a></li>
</ul></li>
</ul>
</nav>
  </div>
</div>

    
    <div class="post-content">
      

<p>当编译过程比较复杂的时候, 我们就可以使用 shell 脚本来简化这个过程, 同时版本升级, 重复构建的基础上 shell 脚本也能够重复利用, 下面直接开始看看 shell 脚本是如何使用的, 先从最简单的开始</p>

<h2 id="hello-shell">hello shell</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/bin/bash
</span><span class="cp"></span>
<span class="c1"># echo 打印输出</span>
<span class="nb">echo</span> <span class="s2">&#34;Hello Shell!&#34;</span></code></pre></td></tr></table>
</div>
</div>
<p><code>#!/bin/bash</code> 第一行一般都是用来声明是用什么解释器来执行, 这里是 Bash , 然后 echo 是用来打印的, 一个简单的 hello shell 脚本就完成了, 然后通过 cmd 执行 ./1.sh 就可以了</p>

<p><img src="https://raw.githubusercontent.com/midFang/imgSource/main/QQ20240805-163710.png" alt="" /></p>

<h2 id="变量">变量</h2>

<ul>
<li><p>变量的设置规则</p>

<ol>
<li>命名跟 Java 规范一样, 不能以数字开头等</li>
<li>shell 中默认都是字符串类，如果需要用到其他类型，需要额外处理</li>
<li>变量用等号连接，不能有空格</li>

<li><p>变量的值如果有空格，需要用单引号或者双引号包括</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/bin/bash
</span><span class="cp"></span>
<span class="c1"># 变量</span>
<span class="nv">str1</span><span class="o">=</span><span class="s2">&#34;str11&#34;</span>
<span class="nv">str2</span><span class="o">=</span>str1 <span class="c1"># 赋值</span>
<span class="nv">str3</span><span class="o">=</span><span class="m">32</span> <span class="c1"># 数字会被默认当作字符串处理</span>

<span class="nb">echo</span> <span class="s2">&#34;str1 = </span><span class="si">${</span><span class="nv">str1</span><span class="si">}</span><span class="s2">&#34;</span>
<span class="nb">echo</span> <span class="s2">&#34;str2 = </span><span class="nv">$str2</span><span class="s2">&#34;</span>
<span class="nb">echo</span> <span class="s2">&#34;str3 = </span><span class="nv">$str3</span><span class="s2">&#34;</span>

<span class="c1"># 输出环境变量 CMAKE_PATH</span>
<span class="nb">echo</span> <span class="s2">&#34;CMAKE_PATH = </span><span class="si">${</span><span class="nv">CMAKE_PATH</span><span class="si">}</span><span class="s2">&#34;</span>

<span class="c1"># 指定一个命令的执行结果返回给变量 (pwd 是当前的工作目录)</span>
<span class="nv">soPath</span><span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>
<span class="nb">echo</span> <span class="s2">&#34;sopath = </span><span class="si">${</span><span class="nv">soPath</span><span class="si">}</span><span class="s2">&#34;</span></code></pre></td></tr></table>
</div>
</div></li>
</ol></li>
</ul>

<p>代码都比较简单, 语法也基本是固定格式, 运行后, 结果如下</p>

<p><img src="https://raw.githubusercontent.com/midFang/imgSource/main/2.png" alt="" /></p>

<h2 id="获取参数">获取参数</h2>

<ol>
<li><code>$n</code> 来获取参数,$0 代表程序本身，<code>$1-$9</code>代表第一个参数到第九个参数，十以上的参数要用大括号 <code>${10}</code></li>
<li><code>$*</code> 代表的是命令中的所有参数，但是会把参数看成一个整体 <code>&quot;$0,$1,$2,$3,$4...$n&quot;</code></li>
<li><code>$@</code> 代表命令中的所有参数，但是会把参数区分对待 <code>&quot;$0&quot;,&quot;$1&quot;,&quot;$2&quot;...&quot;$n&quot;</code></li>

<li><p><code>$#</code> 代表参数中的个数</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/bin/bash
</span><span class="cp"></span>
<span class="nb">echo</span> <span class="s2">&#34;</span><span class="nv">$0</span><span class="s2">=</span><span class="nv">$0</span><span class="s2">&#34;</span>
<span class="nb">echo</span> <span class="s2">&#34;\$1=</span><span class="nv">$1</span><span class="s2">&#34;</span>
<span class="nb">echo</span> <span class="s2">&#34;\$2=&#34;</span><span class="nv">$2</span>

<span class="nb">echo</span> <span class="s2">&#34;\$*=&#34;</span><span class="nv">$*</span>
<span class="nb">echo</span> <span class="s2">&#34;\$@=&#34;</span><span class="nv">$@</span>
<span class="nb">echo</span> <span class="s2">&#34;\$#=&#34;</span><span class="nv">$#</span>

<span class="c1">#每次逻动（删除）第一个参数</span>
<span class="nb">shift</span>

<span class="nb">echo</span> <span class="s2">&#34;\$1=</span><span class="nv">$1</span><span class="s2">&#34;</span>
<span class="nb">echo</span> <span class="s2">&#34;\$@=&#34;</span><span class="nv">$@</span>

<span class="nb">echo</span> <span class="s2">&#34;========================================&#34;</span>
<span class="k">for</span> i in <span class="nv">$*</span>
<span class="k">do</span>
<span class="nb">echo</span> <span class="nv">$i</span>
<span class="k">done</span>

<span class="nb">echo</span> <span class="s2">&#34;========================================&#34;</span>
<span class="k">for</span> i in <span class="nv">$@</span>
<span class="k">do</span>
<span class="nb">echo</span> <span class="nv">$i</span>
<span class="k">done</span>

<span class="nb">echo</span> <span class="s2">&#34;========================================&#34;</span>
<span class="k">for</span> i in <span class="s2">&#34;</span><span class="nv">$@</span><span class="s2">&#34;</span>
<span class="k">do</span>
<span class="nb">echo</span> <span class="nv">$i</span>
<span class="k">done</span>

<span class="nb">echo</span> <span class="s2">&#34;========================================&#34;</span>
<span class="k">for</span> i in <span class="s2">&#34;</span><span class="nv">$*</span><span class="s2">&#34;</span>
<span class="k">do</span>
<span class="nb">echo</span> <span class="nv">$i</span>
<span class="k">done</span></code></pre></td></tr></table>
</div>
</div></li>
</ol>

<p><img src="https://raw.githubusercontent.com/midFang/imgSource/main/3.png" alt="" /></p>

<p>还有一些，读取控制台上的输入赋值给变量</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># 获取用户及时输入的参数</span>
<span class="c1">#read -p &#34;please input your name!&#34; name</span>
<span class="c1">#echo &#34;name = $name&#34;</span></code></pre></td></tr></table>
</div>
</div>
<p>read 表示读取用户输入，然后将其存储出 name 中</p>

<p><img src="https://raw.githubusercontent.com/midFang/imgSource/main/5.png" alt="" /></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="nb">read</span> -sp <span class="s2">&#34;please input your password&#34;</span> <span class="nb">pwd</span>
<span class="nb">echo</span> <span class="s2">&#34;password=</span><span class="nv">$pwd</span><span class="s2">&#34;</span></code></pre></td></tr></table>
</div>
</div>
<p>这里和上面的区别就是， -sp 会将密码隐藏起来，并赋值给 pwd，执行结果如下</p>

<p><img src="https://raw.githubusercontent.com/midFang/imgSource/main/QQ20240805-181600.png" alt="" /></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="nb">read</span> -t <span class="m">5</span> -n <span class="m">1</span> -p <span class="s2">&#34;please input [y|n]&#34;</span> input
<span class="nb">echo</span> <span class="s2">&#34;input = </span><span class="nv">$input</span><span class="s2">&#34;</span> </code></pre></td></tr></table>
</div>
</div>
<p>这里代表的意思是：</p>

<ul>
<li><code>read</code> 命令来读取用户输入</li>
<li><code>-t 5</code>：设置一个超时时间为 5 秒。如果用户在 5 秒内没有输入内容，read 命令将会自动结束，并且 input 变量会为空</li>
<li><code>-n 1</code>：指定读取一个字符的输入（即用户输入一个字符后 read 命令会立即结束，而不需要等待用户按下 Enter 键）</li>
<li><code>-p &quot;please input [y|n]: &quot;</code>：在读取用户输入前，显示提示信息 <code>&quot;please input [y|n]: &quot;</code></li>
</ul>

<h2 id="预定义变量">预定义变量</h2>

<blockquote>
<p>指的是 bash 中已经定义好的，我们可以直接拿过来用</p>
</blockquote>

<ol>
<li><code>$?</code>:返回的是上一个执行命令的返回值，执行成功返回 0 ，执行失败返回非0</li>
<li><code>$$</code>:获取当前角本的进程号</li>
<li><code>$!</code>:获取最后一个后台执行的进程号</li>
</ol>

<p><img src="https://raw.githubusercontent.com/midFang/imgSource/main/4.png" alt="" /></p>

<h2 id="条件判断和数字使用">条件判断和数字使用</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># 条件判断 test expression 或者 []</span>
<span class="c1"># 测试的范围：整数，字符串，文件</span>

<span class="nv">num1</span><span class="o">=</span><span class="m">1</span>
<span class="nv">num2</span><span class="o">=</span><span class="m">2</span>
<span class="c1"># 计算和， 注意默认情况下，shell 当作是字符串</span>
<span class="nv">num3</span><span class="o">=</span><span class="nv">$num1</span>+<span class="nv">$num2</span>
<span class="nb">echo</span> <span class="nv">$num3</span>

<span class="c1"># 数字的计算， 使用 expr 命令， 或者 $(())</span>
<span class="nv">num4</span><span class="o">=</span><span class="k">$((</span><span class="nv">$num1</span><span class="o">+</span><span class="nv">$num2</span><span class="k">))</span>
<span class="nb">echo</span> <span class="nv">$num4</span>

<span class="c1"># 执行的是 expr 命令，注意需要有空格</span>
<span class="nv">num5</span><span class="o">=</span><span class="sb">`</span>expr <span class="nv">$num1</span> + <span class="nv">$num2</span><span class="sb">`</span>
<span class="nb">echo</span> <span class="nv">$num5</span></code></pre></td></tr></table>
</div>
</div>
<p>执行的结果如下</p>

<p><img src="https://raw.githubusercontent.com/midFang/imgSource/main/202408080f956328.png" alt="" /></p>

<h3 id="条件判断">条件判断</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></pre></td>
<td class="lntd">
<pre class="chroma">1. [ str ] 测试字符串是否不为空
2. test -n str 测试字符串是否不为空或者是 [ -n str ] 
3. test -z str 测试字符串是否为空或者是 [ -z str ] 
4. [ str1 = str2 ] 是否相等</pre></td></tr></table>
</div>
</div>
<h3 id="数字">数字：</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></pre></td>
<td class="lntd">
<pre class="chroma">1. [ num1 -eq num2 ] 测试是否相等
2. [ num1 -ne num2 ] 不等
3. [ num1 -ge num2 ] &gt;=
4. [ num1 -gt num2 ] &gt;
5. [ num1 -le num2 ] &lt;=
6. [ num1 -lt num2 ] &lt;</pre></td></tr></table>
</div>
</div>
<h3 id="文件">文件：</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></pre></td>
<td class="lntd">
<pre class="chroma">1. test -d file  目录
2. test -f file   普通文件
3. test -e file  存在
4. test -L file  链接
5. test -r file   可读
6. test -w file  可写
7. test -x file   可执行</pre></td></tr></table>
</div>
</div>
<p>接下来让我们编写一个根据用户输入编译类型来编译出对应的构建产物，这在实际的场景中也挺场景的</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/bin/bash
</span><span class="cp"></span>
<span class="c1"># 判断有没有输入 （ $1 是取的第一个参数）</span>
<span class="k">if</span> <span class="o">[</span> -z <span class="nv">$1</span> <span class="o">]</span>
<span class="k">then</span>
        <span class="nb">echo</span> 请输入需要编译的 <span class="nb">type</span> 【Release or Debug】
        <span class="nb">exit</span> <span class="c1"># 结束掉执行</span>
<span class="k">fi</span> <span class="c1"># 结束 if 语句</span>

<span class="c1"># 定义变量，指定编译类型</span>
<span class="nv">CMAKE_BUILD_TYPE</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;Debug&#34;</span> <span class="o">=</span> <span class="nv">$1</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
        <span class="nv">CMAKE_BUILD_TYPE</span><span class="o">=</span><span class="s2">&#34;Debug&#34;</span>
<span class="k">elif</span> <span class="o">[</span> <span class="s2">&#34;Release&#34;</span> <span class="o">=</span> <span class="nv">$1</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
        <span class="nv">CMAKE_BUILD_TYPE</span><span class="o">=</span><span class="s2">&#34;Release&#34;</span>
<span class="k">else</span> <span class="nb">echo</span> 请输入需要编译的 <span class="nb">type</span> 【Release or Debug】
        <span class="nb">exit</span>

<span class="k">fi</span>

<span class="nb">echo</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">CMAKE_BUILD_TYPE</span><span class="si">}</span><span class="s2"> 正在开始编译中， 请稍后&#34;</span></code></pre></td></tr></table>
</div>
</div>
<p><img src="https://raw.githubusercontent.com/midFang/imgSource/main/202408081007076.png" alt="" /></p>

<h2 id="函数">函数</h2>

<p>在上面的例子中，提示的错误信息都是一样的， 这里可以用一个函数封装起来</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/bin/bash
</span><span class="cp"></span>
<span class="c1"># 函数需要使用的话， 需要先定义</span>
<span class="k">function</span> error<span class="o">(){</span>
        <span class="nb">echo</span> 请输入需要编译的 <span class="nb">type</span> 【Release or Debug】
        <span class="nb">echo</span> <span class="s2">&#34;方法参数的输入 \$1 = </span><span class="si">${</span><span class="nv">1</span><span class="si">}</span><span class="s2">&#34;</span>  <span class="c1">#函数需要传参数 arm $1 参数不是代表的脚本参数，而是方法传递过来的参数</span>

                <span class="nb">exit</span>
<span class="o">}</span>

<span class="k">if</span> <span class="o">[</span> -z <span class="nv">$1</span> <span class="o">]</span>
<span class="k">then</span> error <span class="nb">exit</span> <span class="c1"># 函数使用</span>
<span class="k">fi</span> 

<span class="nv">CMAKE_BUILD_TYPE</span><span class="o">=</span><span class="s2">&#34;&#34;</span>
<span class="k">if</span> <span class="o">[</span> <span class="s2">&#34;Debug&#34;</span> <span class="o">=</span> <span class="nv">$1</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
        <span class="nv">CMAKE_BUILD_TYPE</span><span class="o">=</span><span class="s2">&#34;Debug&#34;</span>
<span class="k">elif</span> <span class="o">[</span> <span class="s2">&#34;Release&#34;</span> <span class="o">=</span> <span class="nv">$1</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
        <span class="nv">CMAKE_BUILD_TYPE</span><span class="o">=</span><span class="s2">&#34;Release&#34;</span>
<span class="k">else</span> error arm  <span class="c1"># 函数使用， 并传递参数</span>

<span class="k">fi</span>

<span class="nb">echo</span> <span class="s2">&#34;</span><span class="si">${</span><span class="nv">CMAKE_BUILD_TYPE</span><span class="si">}</span><span class="s2"> 正在开始编译中， 请稍后&#34;</span></code></pre></td></tr></table>
</div>
</div>
<p>这里将相同的逻辑部分， 都封装了在 error 中，其余的基本不变， 需要注意的是 error 内部 $1 接受到的参数区别，不是脚本传过来的参数，而是方法传递过来的参数，
运行后如下</p>

<p><img src="https://raw.githubusercontent.com/midFang/imgSource/main/202408081007988.png" alt="" /></p>

<h2 id="循环和switch">循环和switch</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="nb">echo</span> <span class="s2">&#34;==========================================&#34;</span>
<span class="k">for</span><span class="o">((</span><span class="nv">i</span><span class="o">=</span><span class="m">0</span><span class="p">;</span>i&lt;<span class="m">10</span><span class="p">;</span>i++<span class="o">))</span>
<span class="k">do</span>
<span class="nb">echo</span> <span class="nv">$i</span>
<span class="k">done</span>

<span class="nb">echo</span> <span class="s2">&#34;==========================================&#34;</span>
<span class="nv">sum</span><span class="o">=</span><span class="m">0</span>
<span class="nv">i</span><span class="o">=</span><span class="m">1</span>
<span class="k">while</span><span class="o">((</span><span class="nv">$i</span>&lt;<span class="o">=</span><span class="m">100</span><span class="o">))</span>
<span class="k">do</span>
        <span class="nv">sum</span><span class="o">=</span><span class="k">$((</span><span class="nv">$sum</span><span class="o">+</span><span class="nv">$i</span><span class="k">))</span>
        <span class="nv">i</span><span class="o">=</span><span class="k">$((</span><span class="nv">$i</span><span class="o">+</span><span class="m">1</span><span class="k">))</span>
<span class="k">done</span>
<span class="nb">echo</span> <span class="s2">&#34;sum = </span><span class="nv">$sum</span><span class="s2">&#34;</span>

<span class="nb">echo</span> <span class="s2">&#34;==========================================&#34;</span>
<span class="k">case</span> <span class="nv">$1</span> in <span class="c1"># 读取终端输入的第一个参数</span>
start<span class="o">)</span> <span class="c1"># 命中 start 条件</span>
        <span class="nb">echo</span> <span class="s2">&#34;start service&#34;</span>
        <span class="p">;;</span>
stop<span class="o">)</span> <span class="c1"># 命中 stop</span>
        <span class="nb">echo</span> <span class="s2">&#34;stop service&#34;</span>
        <span class="p">;;</span>
*<span class="o">)</span> <span class="c1"># 所有条件都没有命中</span>
        <span class="nb">echo</span> <span class="s2">&#34;invalid command&#34;</span>
        <span class="nb">echo</span> <span class="s2">&#34;Usage:{start|stop}&#34;</span>
<span class="k">esac</span> <span class="c1"># esac 是 case 语句的结束标志</span></code></pre></td></tr></table>
</div>
</div>
<p>执行后结果如下</p>

<p><img src="https://raw.githubusercontent.com/midFang/imgSource/main/202408081008307.png" alt="" /></p>

<h2 id="输出日志到文件中">输出日志到文件中</h2>

<h3 id="临时重定向">临时重定向</h3>

<p><strong>临时重定向</strong>是指一次性地将命令的输出重定向到某个文件或设备。常用的重定向符号有：</p>

<ul>
<li><code>&gt;</code>：将标准输出（<code>stdout</code>，文件描述符1）重定向到一个文件，会覆盖文件的内容</li>
<li><code>&gt;&gt;</code>：将标准输出重定向到一个文件，会追加到文件末尾</li>
<li><code>2&gt;</code>：将标准错误（<code>stderr</code>，文件描述符2）重定向到一个文件，会覆盖文件内容</li>

<li><p><code>2&gt;&gt;</code>：将标准错误重定向到一个文件，会追加到文件末尾</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># 临时重定向，&gt; 代表写入到文件中，会被覆盖</span>
<span class="nb">echo</span> <span class="s2">&#34;log error&#34;</span> &gt; log.txt
<span class="nb">echo</span> <span class="s2">&#34;log error 2&#34;</span> &gt; log.txt

<span class="c1"># &gt;&gt; 代表的是追加</span>
<span class="nb">echo</span> <span class="s2">&#34;log error 3&#34;</span> &gt;&gt; log.txt</code></pre></td></tr></table>
</div>
</div></li>
</ul>

<p>执行结果后， 会生成 log.txt， 文件信息是这样的</p>

<p><img src="https://raw.githubusercontent.com/midFang/imgSource/main/202408081009291.png" alt="" /></p>

<h3 id="永久重定向">永久重定向</h3>

<p><strong>永久重定向</strong>是使用 <code>exec</code> 命令改变当前 Shell 环境中文件描述符的默认目的地，直到 Shell 会话结束或被再次更改。永久重定向对所有后续命令生效，而不仅仅是单个命令</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># 永久重定向 echo 标准输入，0标准输出，1标准错误，2追加</span>
<span class="nb">exec</span> <span class="m">1</span>&gt;log.txt # 
<span class="nb">exec</span> <span class="m">2</span>&gt;&gt;log.txt

<span class="nb">echo</span> <span class="s2">&#34;h1&#34;</span>
<span class="nb">echo</span> <span class="s2">&#34;h2&#34;</span>
<span class="nb">echo</span> <span class="s2">&#34;h3&#34;</span>

随便输入</code></pre></td></tr></table>
</div>
</div>
<ol>
<li><p><code>exec &gt;log.txt</code>：</p>

<ul>
<li>将标准输出重定向到 <code>log.txt</code>，这意味着之后所有的标准输出都会写入到 <code>log.txt</code>，并覆盖其中已有的内容。</li>
</ul></li>

<li><p><code>exec &gt;&gt;log.txt</code>：</p>

<ul>
<li>将标准输出重定向追加到 <code>log.txt</code>，这意味着之后所有的标准错误都会追加写入到 <code>log.txt</code>。</li>
</ul></li>
</ol>

<p>所以， 执行后，log.txt 文件是这样的</p>

<p><img src="https://raw.githubusercontent.com/midFang/imgSource/main/202408081010593.png" alt="" /></p>

<h2 id="交叉编译">交叉编译</h2>

<p>在上一篇文章中，我们编译了 libmath.so 库， 是在 Linux 中编译的，只能在 Linux 中使用，为了在 Android 平台上能够使用</p>

<p>那么就需要使用交叉编译了，这里我们刚刚已经学习了 shell 脚本编写，接下来使用 shell 脚本，来完成此次的交叉编译</p>

<p>要完成交叉编译，需要安装 NDK，并且配置环境变量，有这么以下几个步骤</p>

<ol>
<li><p>下载 NDK</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="c1"># 在 Linux 中的下载 NDK，在控制台中输入</span>
wget -c https://dl.google.com/android/repository/android-ndk-r27-linux.zip?hl<span class="o">=</span>zh-cn
<span class="c1"># 然后进行解压</span> 
unzip 文件名
<span class="c1"># 解压后，放置到 lib/ndk 目录下</span></code></pre></td></tr></table>
</div>
</div></li>

<li><p>配置NDK环境变量</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">vim ~/.bashrc
<span class="c1"># 在文件末尾追加以下代码：</span>
<span class="nb">export</span> <span class="nv">NDK_PATH</span><span class="o">=</span>/lib/ndk/android-ndk-r27
<span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span><span class="nv">$PATH</span>:<span class="nv">$NDK_PATH</span>

<span class="c1"># 然后更新一下环境变量</span>
<span class="nb">source</span> ~/.bashrc

<span class="c1"># 再试试 ndk-build出现如下说明就安装好了</span>
Android NDK: Could not find application project directory !
Android NDK: Please define the NDK_PROJECT_PATH variable to point to it.
/usr/lib/ndk/android-ndk-r27/build/core/build-local.mk:151: *** Android NDK: Aborting    .  Stop.</code></pre></td></tr></table>
</div>
</div></li>
</ol>

<p><img src="https://raw.githubusercontent.com/midFang/imgSource/main/202408081015780.png" alt="" /></p>

<p>然后使用上一篇文章中的源代码，CMakeLists.txt 有所改变，注意这里必须要添加最低版本声明，不然编译不过去，完整代码如下</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-cmake" data-lang="cmake"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-cmake" data-lang="cmake"><span class="c"># 构建生成 so 库
</span><span class="c"></span><span class="nb">cmake_minimum_required</span><span class="p">(</span><span class="s">VERSION</span> <span class="s">3.22</span><span class="p">)</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="c"># 给工程取一个名字
</span><span class="c"></span><span class="nb">PROJECT</span> <span class="p">(</span><span class="s">Math</span><span class="p">)</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="nb">MESSAGE</span><span class="p">(</span><span class="s">STATUS</span> <span class="s2">&#34;this is PROJECT_SOURCE dir &#34;</span><span class="o">${</span><span class="nv">PROJECT_SOURCE_DIR</span><span class="o">}</span><span class="p">)</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="c"># 指定头文件在哪个目录
</span><span class="c"></span><span class="nb">INCLUDE_DIRECTORIES</span> <span class="p">(</span><span class="o">${</span><span class="nv">PROJECT_SOURCE_DIR</span><span class="o">}</span><span class="s">/include</span><span class="p">)</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="c"># 搜集 src 目录下的所有 .cpp 文件(源文件)
</span><span class="c"># SRC_LIST 代表 src 目录下的所有源文件 
</span><span class="c"></span><span class="nb">AUX_SOURCE_DIRECTORY</span> <span class="p">(</span><span class="o">${</span><span class="nv">PROJECT_SOURCE_DIR</span><span class="o">}</span><span class="s">/src</span> <span class="s">SRC_LIST</span><span class="p">)</span><span class="err">
</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="c"># 指定 so 的生成目录 lib
</span><span class="c"></span><span class="nb">SET</span> <span class="p">(</span><span class="s">LIBRARY_OUTPUT_PATH</span> <span class="o">${</span><span class="nv">PROJECT_SOURCE_DIR</span><span class="o">}</span><span class="s">/lib</span><span class="p">)</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="nb">MESSAGE</span> <span class="p">(</span><span class="s">STATUS</span> <span class="s2">&#34;src_list : &#34;</span><span class="o">${</span><span class="nv">SRC_LIST</span><span class="o">}</span><span class="p">)</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="c"># 指定生成动态库 .so  math -&gt; libmath.so  默认生成的是静态库 
</span><span class="c"></span><span class="nb">ADD_LIBRARY</span> <span class="p">(</span><span class="s">math</span> <span class="s">SHARED</span> <span class="o">${</span><span class="nv">SRC_LIST</span><span class="o">}</span><span class="p">)</span></code></pre></td></tr></table>
</div>
</div>
<p>然后编写脚本文件，其中最重要的是 NDK 相关的一些配置</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash">cmake -DANDROID_NDK<span class="o">=</span><span class="si">${</span><span class="nv">NDK_PATH</span><span class="si">}</span> <span class="se">\ </span><span class="c1">#ndk安装目录</span>
        -DCMAKE_TOOLCHAIN_FILE<span class="o">=</span><span class="si">${</span><span class="nv">NDK_PATH</span><span class="si">}</span>/build/cmake/android.toolchain.cmake <span class="se">\ </span><span class="c1"># NDK 交叉编译工具链</span>
        -DANDROID_ABI<span class="o">=</span><span class="s2">&#34;armeabi-v7a&#34;</span> <span class="se">\ </span><span class="c1"># 指定生成库支持的架构</span>
        -DANDROID_NATIVE_API_LEVEL<span class="o">=</span><span class="m">26</span> <span class="c1"># 指定支持的最低版本</span></code></pre></td></tr></table>
</div>
</div>
<p>完整内容如下</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-bash" data-lang="bash"><span class="cp">#!/bin/bash
</span><span class="cp"></span>
<span class="nb">echo</span> <span class="s2">&#34;NDK_PATH = </span><span class="si">${</span><span class="nv">NDK_PATH</span><span class="si">}</span><span class="s2">&#34;</span>

<span class="c1"># 检查 NDK 路径是否正确</span>
<span class="k">if</span> <span class="o">[</span> ! -d <span class="s2">&#34;</span><span class="nv">$NDK_PATH</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
  <span class="nb">echo</span> <span class="s2">&#34;NDK 路径不存在: </span><span class="nv">$NDK_PATH</span><span class="s2">&#34;</span>
  <span class="nb">exit</span> <span class="m">1</span>
<span class="k">fi</span>

<span class="c1"># 创建并进入构建目录 (目的是为了将构建文件统一放在 build 文件夹中)</span>
mkdir -p build
<span class="nb">cd</span> build

<span class="c1"># 运行 CMake 配置</span>
cmake .. <span class="se">\
</span><span class="se"></span>-DANDROID_NDK<span class="o">=</span><span class="si">${</span><span class="nv">NDK_PATH</span><span class="si">}</span> <span class="se">\ </span><span class="c1"># NDK 安装目录</span>
  -DCMAKE_TOOLCHAIN_FILE<span class="o">=</span><span class="si">${</span><span class="nv">NDK_PATH</span><span class="si">}</span>/build/cmake/android.toolchain.cmake <span class="se">\ </span><span class="c1"># NDK 交叉编译工具链</span>
  -DANDROID_ABI<span class="o">=</span>arm64-v8a <span class="se">\ </span> <span class="c1"># 指定生成库支持的架构</span>
  -DANDROID_NATIVE_API_LEVEL<span class="o">=</span><span class="m">26</span> <span class="c1"># 指定支持的最低版本</span>

<span class="c1"># 运行 make</span>
make</code></pre></td></tr></table>
</div>
</div>
<p>以往我们的编译，我们的编译文件都是和 CMakeLists 文件放在同一级文件夹的，会有些混乱，所以这里我们将构建文件都放在了 build 文件中，然后执行 ./build.sh 就可以编译出 Android 平台上能够使用的 so 库了</p>

<p><img src="https://raw.githubusercontent.com/midFang/imgSource/main/202408081025868.png" alt="" /></p>

<h2 id="android-中-导入第三方-so-库">Android 中 导入第三方 so 库</h2>

<p>这样我们就编译好了得到了 so 库，然后试试在 Android studio 上看看能不能正常使用，创建一个全新的 C++ Android 项目，导入 so 库，它的文件路径是这样的</p>

<p><img src="https://raw.githubusercontent.com/midFang/imgSource/main/202408081027439.png" alt="" /></p>

<p>大致做的步骤是引入头文件，导入 so 库，然后在 C 代码中，调用 so 库的 add 方法，运行后结果如下</p>

<p><img src="https://raw.githubusercontent.com/midFang/imgSource/main/202408081028538.png" alt="" /></p>

<p>可以发现，sum 计算正确，也正常输出了，可以证明我们的 so 库已经成功的在 Android 平台上运行了</p>

    </div>

    
    
<div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">Author</span>
    <span class="item-content">midFang</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">LastMod</span>
    <span class="item-content">
      2024-03-17
      
    </span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">License</span>
    <span class="item-content"><a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a></span>
  </p>
</div>


    
    

    <footer class="post-footer">
      <div class="post-tags">
          <a href="https://midFang.github.io/tags/ndk/">NDK</a>
          <a href="https://midFang.github.io/tags/shell/">shell</a>
          
        </div>

      
      <nav class="post-nav">
        
        
          <a class="next" href="/android-ndk-cmake-simple-use/">
            <span class="next-text nav-default">Android NDK 开发之 cmake 使用</span>
            <span class="prev-text nav-mobile">Next</span>
            
            <i class="iconfont">
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

            </i>
          </a>
      </nav>
    </footer>
  </article>

  
  

  
  

  

  
  
    <div class="post bg-white">
      <script src="https://utteranc.es/client.js"
            repo= "midFang/blog-comments"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
      </script>
    </div>
  

  

  

  

    

  

        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="icon-links">
  
  
    <a href="https://github.com/midFang" rel="me noopener" class="iconfont"
      title="github"  target="_blank"
      >
      <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M512 12.672c-282.88 0-512 229.248-512 512 0 226.261333 146.688 418.133333 350.08 485.76 25.6 4.821333 34.986667-11.008 34.986667-24.618667 0-12.16-0.426667-44.373333-0.64-87.04-142.421333 30.890667-172.458667-68.693333-172.458667-68.693333C188.672 770.986667 155.008 755.2 155.008 755.2c-46.378667-31.744 3.584-31.104 3.584-31.104 51.413333 3.584 78.421333 52.736 78.421333 52.736 45.653333 78.293333 119.850667 55.68 149.12 42.581333 4.608-33.109333 17.792-55.68 32.426667-68.48-113.706667-12.8-233.216-56.832-233.216-253.013333 0-55.893333 19.84-101.546667 52.693333-137.386667-5.76-12.928-23.04-64.981333 4.48-135.509333 0 0 42.88-13.738667 140.8 52.48 40.96-11.392 84.48-17.024 128-17.28 43.52 0.256 87.04 5.888 128 17.28 97.28-66.218667 140.16-52.48 140.16-52.48 27.52 70.528 10.24 122.581333 5.12 135.509333 32.64 35.84 52.48 81.493333 52.48 137.386667 0 196.693333-119.68 240-233.6 252.586667 17.92 15.36 34.56 46.762667 34.56 94.72 0 68.522667-0.64 123.562667-0.64 140.202666 0 13.44 8.96 29.44 35.2 24.32C877.44 942.592 1024 750.592 1024 524.672c0-282.752-229.248-512-512-512"></path>
</svg>

    </a>
  
    <a href="https://stackoverflow.com/users/14331888/midfang" rel="me noopener" class="iconfont"
      title="stack-overflow"  target="_blank"
      >
      <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M809.714286 932.571429l-638.857143 0 0-274.285714-91.428571 0 0 365.714286 821.714286 0 0-365.714286-91.428571 0 0 274.285714zm-538.285714-299.428571l18.857143-89.714286 447.428571 94.285714-18.857143 89.142857zm58.857143-213.714286l38.285714-83.428571 414.285714 193.714286-38.285714 82.857143zm114.857143-203.428571l58.285714-70.285714 350.857143 293.142857-58.285714 70.285714zm226.857143-216l272.571429 366.285714-73.142857 54.857143-272.571429-366.285714zm-410.285714 840.571429l0-90.857143 457.142857 0 0 90.857143-457.142857 0z"></path>
</svg>

    </a>
  
    <a href="https://www.douban.com/people/194654920/" rel="me noopener" class="iconfont"
      title="douban"  target="_blank"
      >
      <svg class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="36" height="36">
  <path d="M926.917973 37.80608C959.65184 37.80608 986.19392 64.34816 986.19392 97.082027L986.19392 926.917973C986.19392 959.65184 959.65184 986.19392 926.917973 986.19392L97.082027 986.19392C64.34816 986.19392 37.80608 959.65184 37.80608 926.917973L37.80608 97.082027C37.80608 64.34816 64.34816 37.80608 97.082027 37.80608zM176.653653 176.19968 176.653653 252.678827 825.658027 252.678827 825.658027 176.19968zM217.719467 316.146347 217.719467 628.08064 273.524053 628.08064 341.292373 770.39616 157.259093 770.39616 157.259093 845.417813 842.949973 845.417813 842.949973 770.39616 654.226773 770.39616 722.899627 628.08064 783.67744 628.08064 783.67744 316.146347zM684.885333 392.891733 684.885333 553.987413 312.576 553.987413 312.576 392.891733zM570.770773 770.39616 426.653013 770.39616 359.621973 628.08064 639.443627 628.08064z"></path>
</svg>

    </a>


<a href="https://midFang.github.io/index.xml" rel="noopener alternate" type="application/rss&#43;xml"
    class="iconfont" title="rss" target="_blank">
    <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="30" height="30">
  <path d="M819.157333 1024C819.157333 574.592 449.408 204.8 0 204.8V0c561.706667 0 1024 462.293333 1024 1024h-204.842667zM140.416 743.04a140.8 140.8 0 0 1 140.501333 140.586667A140.928 140.928 0 0 1 140.074667 1024C62.72 1024 0 961.109333 0 883.626667s62.933333-140.544 140.416-140.586667zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352 0 678.784 306.517333 678.784 678.826667z"></path>
</svg>

  </a>
   
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - <a class="theme-link" href="https://github.com/xianmin/hugo-theme-jane">Jane</a>
  </span>

  <span class="copyright-year">
    &copy;
    
      2020 -
    2024
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        midFang
        
      </span></span>

  
  
    <span id="busuanzi_container">
      访客数/访问量：<span id="busuanzi_value_site_uv"></span>/<span id="busuanzi_value_site_pv"></span>
    </span>
  

  
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont">
        
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

      </i>
    </div>
  </div>
  
<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="/js/main.638251f4230630f0335d8c6748e53a96f94b72670920b60c09a56fdc8bece214.js" integrity="sha256-Y4JR9CMGMPAzXYxnSOU6lvlLcmcJILYMCaVv3Ivs4hQ=" crossorigin="anonymous"></script>















  <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script type="text/javascript">
    AV.initialize( null ,  null );
  </script>

  <script>
    function showHitCount(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push($(this).attr("id").trim());
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var hits = item.get('hits');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(hits);
          }
          for (var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if (countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function (results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("hits");
            counter.save(null, {
              success: function (counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('hits'));
              },
              error: function (counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
             
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
             
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("hits", 1);
            newcounter.save(null, {
              success: function (newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('hits'));
              },
              error: function (newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function (error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function () {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        
        addCount(Counter);
      } else if ($('.post-link').length > 1) {
        
        showHitCount(Counter);
      }
    });
  </script>





  <script>
    $("#openSearch, #openSearchMobile").click(function(){
      $(".modal-dialog").addClass("visible");
    });

    $("#closeSearch").click(function(){
      $(".modal-dialog").removeClass("visible");
    });

    $(document).click(function(event) {
    
      if (!$(event.target).closest(".modal-content, #openSearch, #openSearchMobile").length) {
        $("body").find(".modal-dialog").removeClass("visible");
      }
    });
  </script>





</body>
</html>
